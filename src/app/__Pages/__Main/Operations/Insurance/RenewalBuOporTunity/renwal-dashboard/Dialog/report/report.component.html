<div>
  <div mat-dialog-title class="dialog-title">
    <h2>Renewal business Opportunity Reports</h2>
    <div class="btnIcon">
      <button mat-icon-button title="Minimize" (click)="minimize()">
        <mat-icon>remove</mat-icon>
      </button>
      <button mat-icon-button title="Restore Down" (click)="maximize()" *ngIf="__isVisible">
        <mat-icon>content_copy</mat-icon>
      </button>
      <button mat-icon-button title="Maximize" (click)="fullScreen()" *ngIf="!__isVisible">
        <mat-icon>check_box_outline_blank </mat-icon>
      </button>
      <button mat-icon-button title="Close" [mat-dialog-close]="">
        <mat-icon>close</mat-icon>
      </button>
    </div>

  </div>
   <mat-dialog-content class="customDialog">
     <div class="card p-3 border-1">
      <ng-template #SearchBtn>
        <p-button type="submit" label="Show" icon="pi pi-eye" iconPos="right" styleClass="p-button-lg"></p-button>
      </ng-template>
       <form [formGroup]="__bu_oportunity_frm" autocomplete="off">
        <div class="row">
          <div class="col-sm-12 d-flex align-items-end justify-content-end">
            <p-selectButton
            [options]="selectBtn"
            formControlName="btn_type"
            optionValue="value"
            styleClass="p-button-lg"
            (onOptionClick)="onItemClick($event)"
            optionLabel="icon">
              <ng-template let-item>
                  <i [class]="item.icon"  [matTooltip]="item.label"></i>
              </ng-template>
          </p-selectButton>
          </div>
        </div>
         <div class="row">
          <div class="col-sm-3">
            <label for="dt_type">Date Periods</label>
            <select class="form-control" formControlName="dt_type" name="dt_type" id="dt_type">
                <option value="">Select</option>
                <option value="D">Today</option>
                <option value="W">This Week</option>
                <option value="M">This Month</option>
                <option value="Y">This Year</option>
                <option value="R">Date Range</option>
            </select>
          </div>
          <div class="col-sm-3">
            <label for="dt_range">Date (From - To)</label>
            <p-calendar
            dateFormat="dd/mm/yy"
            placeholder="Select Date Range"
            formControlName="dt_range"
            selectionMode="range"
            [readonlyInput]="true"
            id="dt_range"
            [showIcon]="true"
            [hideOnDateTimeSelect]="true"
            (onClose)="close($event)"
            [showButtonBar]="true">
            </p-calendar>
          </div>
          <div class="col-sm-3">
            <app-core-srch
            [label] = "'Temporary TIN'"
            [placeholder]="'Search By Temporary TIN'"
            [isPending]="__istemporaryspinner"
            [listItems] = "__tinMst"
            [flag] = "'T'"
            [noDataFoundTitle]="'Sorry!! No Records Found'"
            [noDataFoundSubTitle]="'If your result match,they will appear here'"
            [propertiesToShow] = "['temp_tin_no','client_name']"
            formControlName="temp_tin_no"
            [displayMode]="displayMode_forTemp_Tin"
            (setDisplayMode)="displayMode_forTemp_Tin = $event"
            (selectedItems)="getSelectedItemsFromParent($event)"
            ></app-core-srch>
          </div>
          <div class="col-sm-3">
            <app-core-srch
              [label] = "'Proposer Details'"
              [placeholder]="'Search By Name, Code, Email, Mobile, PAN & DOB'"
              [isPending]="__isClientPending"
              [listItems] = "__clientMst"
              [flag] = "'C'"
              [noDataFoundTitle]="'Sorry!! No Records Found'"
              [noDataFoundSubTitle]="'If your result match,they will appear here'"
              [propertiesToShow] = "['client_code','pan','client_name']"
              formControlName="proposer_name"
              [displayMode]="displayMode_forClient"
              (setDisplayMode)="displayMode_forClient = $event"
              (selectedItems)="getSelectedItemsFromParent($event)"
              ></app-core-srch>
          </div>
         </div>
         <div class="row">
          <div class="col-sm-3">
            <label for="ins_type_id">Type Of Insurance</label>
            <ng-multiselect-dropdown
            id="ins_type_id"
            [placeholder]="'Select Type Of Insurance'"
            [settings]="__insType_setting"
            [data]="__insType"
            formControlName="ins_type_id">
          </ng-multiselect-dropdown>
          </div>
          <div class="col-sm-3">
            <label for="company_id">Company</label>
            <ng-multiselect-dropdown
            id="company_id"
            [placeholder]="'Select Company'"
            [settings]="__comp_setting"
            [data]="__compMst"
            formControlName="company_id">
          </ng-multiselect-dropdown>
          </div>
          <div class="col-sm-3">
            <label for="product_type_id">Product Type</label>
            <ng-multiselect-dropdown
            id="product_type_id"
            [placeholder]="'Select Product Type'"
            [settings]="__prod_type_setting"
            [data]="__prodTypeMst"
            formControlName="product_type_id">
          </ng-multiselect-dropdown>
          </div>
          <div class="col-sm-3">
            <label for="product_id">Product</label>
            <ng-multiselect-dropdown
            id="product_id"
            [placeholder]="'Select Product'"
            [settings]="__prod_setting"
            [data]="__prdMst"
            formControlName="product_id">
          </ng-multiselect-dropdown>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-3">
            <label for="renwal_month">Renewal Upto Month</label>
            <select name="renewal_month" id="renewal_month" class="form-control" formControlName="renewal_month">
              <option value="">Select</option>
              <option [value]="month.id" *ngFor="let month of renewal_month">{{month.month}}</option>
            </select>
          </div>
          <div class="col-sm-3">
            <label for="renewal_year">Renewal Upto Year</label>
            <select name="renewal_year" id="renewal_year" class="form-control" formControlName="renewal_year">
              <option value="">Select</option>
              <option [value]="month.id" *ngFor="let month of renewal_year">{{month.year}}</option>
            </select>
          </div>

          <ng-container *ngIf="__bu_oportunity_frm.value.btn_type == 'A';else noAdv">
            <div class="col-sm-3">
              <label for="brn_cd">Branch</label>
              <ng-multiselect-dropdown
              id="brn_cd" [placeholder]="'Select Branch'"
                [settings]="settingsForbrnch"
                [data]="__brnchMst" formControlName="brn_cd">
              </ng-multiselect-dropdown>
            </div>
            <div class="col-sm-3">
              <label for="bu_type">Business Type</label>
              <ng-multiselect-dropdown id="bu_type" [placeholder]="'Select Business Type'"
                [settings]="settingsForbuType"
                [data]="__bu_type"
                formControlName="bu_type">
              </ng-multiselect-dropdown>
            </div>
        </ng-container>
         <ng-template #noAdv>
            <div class="col-sm-6 d-flex align-items-end justify-content-end">
              <ng-container [ngTemplateOutlet]="SearchBtn"></ng-container>
            </div>
         </ng-template>
        </div>
        <ng-container *ngIf="__bu_oportunity_frm.value.btn_type == 'A'">
           <div class="row">
            <div class="col-sm-3">
              <label for="rm_id">Relationship Manager</label>
              <ng-multiselect-dropdown id="rm_id" [placeholder]="'Select Relationship Manager'"
                [settings]="settingsForRM"
                [data]="__RmMst" formControlName="rm_id">
              </ng-multiselect-dropdown>
            </div>
            <div class="col-sm-3">
              <label for="sub_brk_cd">Sub Broker</label>
              <ng-multiselect-dropdown id="sub_brk_cd" [placeholder]="'Select Sub Broker'"
                [settings]="settingsForsubCode"
                [data]="__subbrkArnMst"
                formControlName="sub_brk_cd">
              </ng-multiselect-dropdown>
            </div>
            <div class="col-sm-3">
              <label for="euin_no">EUIN</label>
              <ng-multiselect-dropdown
              id="euin_no" [placeholder]="'Select Employee'"
                [settings]="settingsForEUIN"
                [data]="__euinMst" formControlName="euin_no">
              </ng-multiselect-dropdown>
            </div>
            <div class="col-sm-3 d-flex align-items-end justify-content-end">
              <ng-container [ngTemplateOutlet]="SearchBtn"></ng-container>
            </div>
           </div>
        </ng-container>
       </form>
     </div>
     <div class="card border-1 mt-2">
      <div class="example_container_header">
        <div class="transTypeCount"></div>
        <div class="btnGrp d-flex"></div>
      </div>
      <div class="container_body">
  <!-- PrimeNg Table with column resize,
            column sorting etc  [reorderableColumns]="true"
            pReorderableColumn-->
            <p-table
            #dt
            (onLazyLoad)="customSort($event)"
            [customSort]="true"
              sortMode="single"
              [lazy]="true"
            [value]="renewal_buMst.data"
            [columns]="__columns" [resizableColumns]="true"
              selectionMode="multiple"
              columnResizeMode="expand" [scrollable]="true"
              scrollHeight="358px"
              [autoLayout]="true" [responsive]="true" styleClass="p-datatable-md p-datatable-gridlines"
              [tableStyle]="{ 'min-width': '150rem'}">
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th  *ngFor="let col of columns" pResizableColumn [pSortableColumn]="col.field" [ngStyle]="{'width':'15rem'}">
                    {{ col.header }}
                    <p-sortIcon *ngIf="col.field!= 'edit' && col.field!= 'ins_application_form'" [field]="col.field">
                    </p-sortIcon>
                  </th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-renewal_bu let-columns="columns">
                <tr tabindex="999">
                  <td *ngFor="let col of columns">
                    <ng-container [ngSwitch]="true">
                      <ng-container *ngSwitchCase="col.field == 'edit'">
                        <p-button icon="pi pi-pencil" (click)="populateDT(renewal_bu)"
                          styleClass="p-button-rounded p-button-primary">
                        </p-button>
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'upload_file'">
                        <p-button icon="pi pi-eye" (click)="DocumentView(renewal_bu)"
                          styleClass="p-button-rounded p-button-success"></p-button>
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'bu_type'">
                        <span #tooltip="matTooltip"
                        [matTooltip]="renewal_bu[col.field] == 'D' ? 'B2C - Direct' : (renewal_bu[col.field] == 'I' ? 'B2C - Indirect' : 'B2B')">
                          {{ renewal_bu[col.field] == 'D' ? 'B2C - Direct' : (renewal_bu[col.field] == 'I' ? 'B2C - Indirect' : 'B2B')}}</span>
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'mode_of_holding'">
                       <span
                       #tooltip="matTooltip"
                       [matTooltip]="renewal_bu[col.field] == 'S' ? 'Single' : (renewal_bu[col.field] == 'J' ? 'Joint' : 'Any Or Survivor')">
                       {{ renewal_bu[col.field] == 'S' ? 'Single' : (renewal_bu[col.field] == 'J' ? 'Joint' : 'Any Or Survivor')}}
                      </span>
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'inv_type'">
                        <span
                        #tooltip="matTooltip"
                        [matTooltip]="renewal_bu[col.field] == 'F' ? 'Fresh' : 'Additional'">
                        {{ renewal_bu[col.field] == 'F' ? 'Fresh' : 'Additional'}}
                      </span>
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'insure_bu_type'">
                        <span
                        #tooltip="matTooltip"
                        [matTooltip]="renewal_bu[col.field] == 'F' ? 'Fresh' : 'Renewal'">
                        {{ renewal_bu[col.field] == 'F' ? 'Fresh' : 'Renewal'}}
                      </span>
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'mode_of_payment'">
                          <span
                          #tooltip="matTooltip"
                          [matTooltip]="renewal_bu[col.field] ? (renewal_bu[col.field] == 'O' ? 'OFFLINE' : (renewal_bu[col.field] == 'N'
                          ? 'ONLINE' : 'CASH')) : 'N/A'"
                          >
                          {{renewal_bu[col.field] ? (renewal_bu[col.field] == 'O' ? 'OFFLINE' : (renewal_bu[col.field] == 'N'
                          ? 'ONLINE' : 'CASH')) : 'N/A'}}
                          </span>

                      </ng-container>

                      <ng-container *ngSwitchCase="col.field == 'mode_of_premium'">
                        <span #tooltip="matTooltip" [matTooltip]="(renewal_bu[col.field] | modeOfPre)">
                         {{renewal_bu[col.field] | modeOfPre}}
                        </span>
                      </ng-container>
                      <ng-container
                        *ngSwitchCase="col.field == 'first_client_kyc_status' || col.field == 'second_client_kyc_status' || col.field == 'third_client_kyc_status'">
                        {{ renewal_bu[col.field] ? (renewal_bu[col.field] == 'Y' ? 'With KYC' : 'Without KYC') : 'N/A'}}
                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'remarks'">
                        <ng-container *ngIf="renewal_bu[col.field];else noRemarks">
                          <p-button #tooltip="matTooltip" [matTooltip]="renewal_bu[col.field]" icon="pi pi-info-circle"
                            styleClass="p-button-rounded p-button-success">
                          </p-button>
                        </ng-container>
                        <ng-template #noRemarks>
                          N/A
                        </ng-template>

                      </ng-container>
                      <ng-container *ngSwitchCase="col.field == 'rcv_datetime'">
                        <span #tooltip="matTooltip" [matTooltip]="(renewal_bu[col.field] | date:'dd-MM-YYYY hh:mma')">{{ renewal_bu[col.field] ? (renewal_bu[col.field] | date:'dd-MM-YYYY hh:mma') : 'N/A' }}</span>
                        </ng-container>

                        <ng-container *ngSwitchCase="col.field == 'amount' || col.field == 'sip_amount'">
                          <span #tooltip="matTooltip" [matTooltip]="(renewal_bu[col.field] | currency:'INR')">{{ renewal_bu[col.field] ? (renewal_bu[col.field] | currency:'INR') : 'N/A' }}</span>
                          </ng-container>
                          <ng-container *ngSwitchCase="col.field == 'entry_date'">
                            <span #tooltip="matTooltip" [matTooltip]="(renewal_bu[col.field] | date:'dd-MM-YYYY')">{{ renewal_bu[col.field] ? (renewal_bu[col.field] | date:'dd-MM-YYYY') : 'N/A' }}</span>
                            </ng-container>
                      <ng-container *ngSwitchDefault>
                        <span #tooltip="matTooltip" [matTooltip]="renewal_bu[col.field]">
                          {{ renewal_bu[col.field] ? renewal_bu[col.field] : 'N/A' }}
                        </span>
                      </ng-container>


                    </ng-container>
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                  <td [attr.colspan]="columns.length" class="noHistoryAvailable">
                     No Records Found
                  </td>
                </tr>
              </ng-template>
            </p-table>
            <!-- End -->

            <!-- Paginator with item per page -->
            <div class="paginator">
              <div class="itemsPerPage d-flex">
                  <label class="mr-3">Items per page: </label>
                  <p-selectButton
                  [options]="ItemsPerPage"
                  [formControl]="__pageNumber"
                  optionLabel="label" optionValue="value"
                  (onOptionClick)="onselectItem($event)"
                  ></p-selectButton>
                </div>

              <div  class="paginatorContainer">
                <ul>
                  <li *ngFor="let paginate of __paginate" (click)="getPaginate(paginate)">
                    <a [attr.disabled]="!paginate.url" [style.cursor]="!paginate.url ? 'not-allowed!important' : ''"
                      *ngIf="(paginate.label | bnkrplc) == 'P'">
                      <mat-icon class="prevNext" [style.cursor]="!paginate.url ? 'not-allowed!important' : ''">
                        keyboard_double_arrow_left</mat-icon>
                    </a>
                    <a [attr.disabled]="!paginate.url" [style.cursor]="!paginate.url ? 'not-allowed!important' : ''"
                      *ngIf="(paginate.label | bnkrplc) == 'N'">
                      <mat-icon class="prevNext" [style.cursor]="!paginate.url ? 'not-allowed!important' : ''">
                        keyboard_double_arrow_right</mat-icon>
                    </a>
                    <a [class]="paginate.active ? 'activePaginator paginateNumber' : 'paginateNumber'"
                      *ngIf="(paginate.label | bnkrplc) != 'P' && (paginate.label | bnkrplc) != 'N'">
                      {{paginate.label}}
                    </a>
                  </li>
                </ul>


              </div>

            </div>
            <!-- End -->

      </div>
     </div>
   </mat-dialog-content>
</div>
