<p-table #primeTbl id="trxDt" [value]="dataSource" [responsive]="true"
          [rowHover]="true"
          styleClass="p-datatable-striped p-datatable-lg"
          [scrollable]="true"
           [scrollHeight]="scroll_height"
          [virtualScroll]="virtual_scroll"
          [virtualRowHeight]="34"
          [columns]="column" [paginator]="true"
          [autoLayout]="true" [totalRecords]="dataSource.length" [pageLinks]="3"
          [rowsPerPageOptions]="[10,50,100,{ showAll: 'All' }]"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [rows]="10"
          [showCurrentPageReport]="true" [globalFilterFields]="getColumns()"
          [tableStyle]="{ 'min-width': min_width }">
          <ng-template pTemplate="header">
            <tr>
              <th *ngFor="let col of column" [pSortableColumn]="col.field" [style.max-width]="col.width"
                [style.min-width]="(col.field != 'amc_name' && col.field != 'scheme_name') ? col.width : '12rem'">
                {{ col.header }}
                <p-sortIcon [field]="col.field" *ngIf="col.field != 'trend'"></p-sortIcon>
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-trxn let-i="rowIndex">
            <tr tabindex="999"
              [ngStyle]="{
                'height':'34px',
                'background-color': flag == 'M' ? (trxn.transaction_subtype.includes('Rejection') ?  '#b70a0a30' : '' ) : ''}">
              <td *ngFor="let col of column"
                [style.max-width]="col.width"
                [style.min-width]="(col.field != 'amc_name' && col.field != 'scheme_name') ? col.width : '12rem'">
                <ng-container [ngSwitch]="true">
                  <ng-container *ngSwitchCase="col.field == 'sl_no'">
                    <p class="m-0">
                      {{i + 1}}
                    </p>
                  </ng-container>

                  <ng-container *ngSwitchCase="col.field == 'sub_brk_cd'">
                    <p class="m-0">{{ (trxn[col.field] && (trxn[col.field] | titlecase)!="Not Provided" &&
                      trxn[col.field]!="BLANK" && trxn[col.field]!='0' && trxn[col.field]!= ' '
                      && (trxn[col.field] | titlecase)!="Not Provid"
                      && (trxn[col.field] | titlecase)!="Notprovided"
                      ) ? trxn[col.field] :
                      'N/A' }}</p>
                  </ng-container>

                  <ng-container *ngSwitchCase="col.field == 'first_client_name'">
                    <p class="m-0">{{ trxn[col.field] ? (trxn[col.field] | titlecase) : 'N/A' }}</p>
                  </ng-container>


                  <ng-container *ngSwitchCase="col.field == 'trans_date'">
                    <p class="m-0">{{ trxn[col.field] ? (trxn[col.field] | date:'dd-MM-YYYY') : 'N/A' }}</p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'scheme_name'">
                    <p class="m-0"
                      matTooltip="{{trxn[col.field] ? (trxn[col.field]  + ' - ' +  trxn['plan_name'] + ' - ' + (trxn['divi_lock_flag'] == 'L' ? 'IDCW Reinvestment' : trxn['option_name'])) : ''}}">
                      {{ trxn[col.field] ? (trxn[col.field] + '-' + trxn['plan_name'] + '-' +
                      (trxn['divi_lock_flag'] == 'L' ? 'IDCW Reinvestment' : trxn['option_name']))
                      : 'N/A'
                      }}</p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'tot_tds'">
                    <p class="m-0" matTooltip="{{(trxn[col.field] && trxn[col.field] != ' ') ? trxn[col.field] : 0}}">
                      {{ (trxn[col.field] && trxn[col.field] != " ") ? trxn[col.field] : 0}}
                    </p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'remarks'">
                    <p class="m-0" [matTooltip]="trxn[col.field]">{{trxn['remarks'] ? (trxn['remarks'] | ellipsis:30):
                      'N/A'}}</p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'monthly_inflow' || col.field == 'monthly_outflow' || col.field == 'monthly_net_inflow'">
                    <p class="m-0" [matTooltip]="(trxn[col.field] | number : '1.2-2')">
                      {{trxn[col.field] ? (trxn[col.field] | currency:"symbol":""): 0}}
                    </p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'ratio'">
                    <p class="m-0"
                    [ngClass]="{'text-danger':trxn?.ratio.toString().includes('-')}"
                    [matTooltip]="trxn[col.field] | number : '1.2-2'">{{trxn[col.field] ? (trxn[col.field]?.toFixed(2)): 0}}</p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'per_of_growth'">
                    <p class="m-0"
                    [ngClass]="{'text-danger':trxn?.per_of_growth.toString().includes('-')}"
                    [matTooltip]="trxn[col.field] | number : '1.2-2'">{{trxn[col.field] ? (trxn[col.field]?.toFixed(2)): 0}}%</p>
                  </ng-container>

                  <ng-container *ngSwitchCase="col.field == 'monthly'">
                    <!-- <p class="m-0">{{trxn[col.field] ? (trxn[col.field] | date:'MMM-YYYY') : 'N/A'}}</p> -->
                    <p class="m-0">{{trxn[col.field] ? trxn[col.field] : 'N/A'}}</p>

                  </ng-container>

                  <ng-container *ngSwitchCase="col.field == 'trend'">
                    <mat-icon
                    style="font-size:30px!important;height: 30px;width: 30px;"
                    [ngClass]="{'text-success':trxn['per_of_growth'] > 0,'text-danger':trxn['per_of_growth'] <= 0}"
                    >
                      arrow_drop_{{trxn['per_of_growth'] <= 0 ? 'down' : 'up'}}
                    </mat-icon>
                  </ng-container>
                  <ng-container *ngSwitchDefault>
                    <p class="m-0" [matTooltip]="trxn[col.field]">{{ trxn[col.field] ? trxn[col.field] : 'N/A' }}</p>
                  </ng-container>
                </ng-container>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptymessage" let-columns>
            <tr>
              <td [attr.colSpan]="columns.length" class="noHistoryAvailable">
                <h5>No Records Found</h5>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="loadingbody" let-columns="columns">
            <tr style="height:34px">
                <td *ngFor="let col of columns; let even = even">
                    <p-skeleton [ngStyle]="{'width': col.width}"></p-skeleton>
                </td>
            </tr>
        </ng-template>
        </p-table>
