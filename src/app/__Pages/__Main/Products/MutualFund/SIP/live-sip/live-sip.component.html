
<core-report-filter
(getsearchValues)="searchSipReport($event)"
[title]="__title"
[amcMst]="amc"
[clientMst]="client"
[type]="sipType"
[state]= "state"
(changeState)="changeState($event)"
[report_type]="report_type"
[sip_stp_swp_type_mst]="sip_stp_swp_type_mst"
></core-report-filter>


 <!--<div class="card">
    <div class="card-header sticky-header py-1 px-3 d-flex flex-column">
      <div class="w-100 d-flex justify-content-between align-items-center">
      <b class="m-0 d-flex align-items-center">
        <i class="pi pi-database mr-1" style="font-size:2rem"></i>Live SIP Reports</b>
      <div class="flex w-25">
        <span class="ml-auto">
            <input id="search" class="form-control rounded" type="text"
            (input)="filterGlobal($event)"
            placeholder="Search"
             />
        </span>
      </div>
     </div>
     </div>
    <div class="card-body">-->
<mat-card>
  <mat-card-header class="align-items-center">
    <mat-card-title class="d-flex items-center justify-content-between">
      <!-- <p class="m-0">{{__title}} Reports </p>  -->
      <button
      pButton 
      type="button"
      (click)="exportExcel()"
      class="p-button-outlined"> 
      <i class="pi pi-file-excel text-success" style="font-size: 2rem"></i>
     </button>
    </mat-card-title>
    <div class="my-auto marque__tag">
      <merque
      [type]="__title"
      [trxn_type]="report_type"
      [trxn_sub_type]="sipType"
      [number]="live_sip_rpt.length"
      [value]="total_live_sip_amt "
      [pause_trxn_type_count]="pause_sip_count"
      ></merque>
    </div>
    <div class="my-auto w-25 pr-4">
      <span class="ml-auto">
        <input id="search" class="form-control rounded" type="text"
               (input)="filterGlobal($event)"
               placeholder="Search" />
      </span>
    </div>
  </mat-card-header>
  <mat-card-content>
    <p-table #primeTbl
             id="trxDt"
             [scrollable]="true" [scrollHeight]="'370px'"
             [virtualScroll]="true"
             [virtualRowHeight]="33"
             [value]="live_sip_rpt"
             [responsive]="true"
             [rowHover]="true"
             styleClass="p-datatable-striped"
             [autoLayout]="true"
             appendTo="body"
             [columns]="column"
             [paginator]="true"
             [totalRecords]="live_sip_rpt.length"
             [pageLinks]="3"
             [rowsPerPageOptions]="[10,50,100,{ showAll: 'All' }]"
             currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
             [rows]="10"
             [showCurrentPageReport]="true"
             [tableStyle]="{ 'min-width': '406rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th *ngFor="let col of column" [pSortableColumn]="col.field"
              [style.min-width]="col.width"
              [style.max-width]="col.width">
            {{ col.header }}
            <p-sortIcon [field]="col.field">
            </p-sortIcon>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-trxn let-columns="columns" let-i="rowIndex">
        <tr tabindex="999"
        [ngStyle]="{'background-color':(trxn.pause_end_date && trxn.pause_start_date) ? '#fcf8e3' : '',
          'color':(trxn.pause_end_date && trxn.pause_start_date) ? '#8a6d3b' : '',
          'height':'33px'
        }"
        >
          <td *ngFor="let col of column"
              [style.max-width]="col.width"
              [style.min-width]="col.width"
               [ngStyle]="{'font-weight':(trxn.pause_end_date && trxn.pause_start_date) ? 700 : 500}"
              >
            <ng-container [ngSwitch]="true">
              <ng-container *ngSwitchCase="col.field == 'sl_no'">
                <p class="m-0">{{i + 1}}</p>
              </ng-container>
              <ng-container *ngSwitchCase="col.field == 'from_date' || col.field == 'to_date' || col.field == 'reg_date'">
                <p class="m-0">{{ trxn[col.field] ? (trxn[col.field] | date:'dd-MM-YYYY') : 'N/A' }}</p>
              </ng-container>

              <ng-container *ngSwitchCase="col.field == 'scheme_name'">
                <p class="m-0">{{ trxn[col.field] ? (trxn[col.field]  + '-' + trxn['plan_name'] + '-' + trxn['option_name']) : 'N/A' }}</p>
              </ng-container>
              <ng-container *ngSwitchCase="col.field == 'amount'">
                <p class="m-0" [matTooltip]="trxn[col.field]">{{ trxn[col.field] ? (trxn[col.field]) : 0 }}</p>
              </ng-container>
              <ng-container *ngSwitchCase="col.field == 'sip_date' || col.field =='freq'">
                <p class="m-0" [matTooltip]="trxn[col.field]">{{ trxn[col.field] ? (trxn[col.field].toString() | titlecase) : 'N/A' }}</p>
                </ng-container>
                <ng-container *ngSwitchCase="col.field == 'sub_brk_cd'">
                  <p class="m-0">{{ (trxn[col.field] && (trxn[col.field] | titlecase)!="Not Provided" && trxn[col.field]!="BLANK"
                  && trxn[col.field]!='0' && trxn[col.field]!= ' '
                  && (trxn[col.field] | titlecase)!="Not Provid"
                  && (trxn[col.field] | titlecase)!="Notprovided"
                  && trxn[col.field] !="NOTPROVIDE"
                  ) ? trxn[col.field] : 'N/A' }}</p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'remarks'">
                    <p class="m-0" [matTooltip]="trxn[col.field]">{{(trxn['remarks'] && trxn['remarks']!= ' ') ? (trxn['remarks'] | lowercase | ellipsis:30):
                      'N/A'}}</p>
                  </ng-container>
                  <ng-container *ngSwitchCase="col.field == 'first_client_name' || col.field == 'bank_name'">
                    <p class="m-0">{{ trxn[col.field] ? (trxn[col.field] | titlecase) : 'N/A' }}</p>
                    </ng-container>


              <ng-container *ngSwitchDefault>
                <p class="m-0" [matTooltip]="trxn[col.field]">{{ trxn[col.field] ? trxn[col.field] : 'N/A' }}</p>
              </ng-container>
            </ng-container>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage" let-columns>
        <tr>
          <td [attr.colSpan]="columns.length" class="noHistoryAvailable">
            No Records Found
          </td>
        </tr>
      </ng-template>
      <!-- <ng-template pTemplate="footer">
        <tr >
          <td  *ngFor="let col of column"
          [attr.colspan]="col.field == 'sl_no' ? 5 : ''"
          [style.min-width]="col.field == 'sl_no' ? '40rem' : ''"
          [style.min-width]="col.field == 'sl_no' ? '40rem' : ''">
            <ng-container [ngSwitch]="true">
              <ng-container *ngSwitchCase="col.field == 'sl_no'">
               <p class="m-0 text-left">
                SIP (TOTAL: {{live_sip_rpt.length}}) (Value: {{total_live_sip_amt | number : '1.2-2'}})
               </p>
             </ng-container>
              </ng-container>
          </td>
       </tr>
      </ng-template> -->
    </p-table>
    <div class="my-3 p-2" *ngIf="disclaimer">
      <p 
      [ngStyle]="{
        'font-size':disclaimer ? (disclaimer?.font_size + 'px')  : '',
        'color':disclaimer ? disclaimer?.color_code : ''
      }"

      >{{disclaimer ? disclaimer?.dis_des : ''}}</p>
    </div>
  </mat-card-content>

</mat-card>

    <!--</div>
    <div class="card-footer">
      <b>
        In Total There Are {{live_sip_rpt.length}} Live SIP
      </b>
    </div>
  </div>-->
