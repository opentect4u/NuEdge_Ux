<div class="row flexSec">
  <div class="col-sm-12">
    <div class="card">
      <div class="card-header">
        <h4 clas="p-2">Search Nav</h4>
      </div>
       <div class="card-body p-3">
            <form [formGroup]="searchNavForm" (ngSubmit)="searchNav()">
              <div class="row">
                <div class="col-sm-3">
                  <mat-radio-group color="primary" aria-label="Select an option" formControlName="plan_type">
                    <!-- <mat-radio-button value="D">Direct</mat-radio-button>
                    <mat-radio-button value="R" class="ml-3">Regular</mat-radio-button> -->
                    <mat-radio-button [value]="item.id" *ngFor="let item of md_plan">{{item.plan_name}}</mat-radio-button>
                  </mat-radio-group>
                </div>
              </div>
              <div class="row">

              <div class="col-sm-3">
                <label for="amc_id">AMC</label>
                    <ng-multiselect-dropdown
                    #amcDrpdown
                    [attr.id]="'amc_id'"
                    [placeholder]="'Select AMC'"
                    [settings]="amc_settings"
                    (onDeSelect)="deSelect($event,'A')"
                    [data]="amc_dtls"
                    formControlName="amc_id">
                  </ng-multiselect-dropdown>
              </div>
              <div class="col-sm-3">
                <label for="cat_id">Category</label>
                    <ng-multiselect-dropdown
                    [attr.id]="'cat_id'"
                    [placeholder]="'Select Category'"
                    [settings]="cat_settings"
                    (onDeSelect)="deSelect($event,'C')"
                    [data]="cat_dtls"
                    formControlName="cat_id">
                  </ng-multiselect-dropdown>
              </div>
              <div class="col-sm-3">
                <label for="subcat_id">Sub Category</label>
                    <ng-multiselect-dropdown
                    [attr.id]="'subcat_id'"
                    [placeholder]="'Select Sub Category'"
                    [settings]="subcat_settings"
                    (onDeSelect)="deSelect($event,'S')"
                    [data]="subcat_dtls"
                    formControlName="subcat_id">
                  </ng-multiselect-dropdown>
              </div>
              <div class="col-sm-3">
                <label for="scheme_id">Scheme</label>
                    <ng-multiselect-dropdown
                    [attr.id]="'scheme_id'"
                    [placeholder]="'Select Scheme'"
                    [settings]="scheme_settings"
                    (onDeSelect)="deSelect($event,'SC')"
                    [data]="scheme_dtls"
                    formControlName="scheme_id">
                  </ng-multiselect-dropdown>
              </div>


              </div>
              <div class="row">
                  <div class="col-sm-3">
                    <label for="date_periods">Date Periods</label>
                    <select name="date_periods" id="date_periods" class="form-control" formControlName="date_periods">
                        <option value="">Select</option>
                        <option [value]="date.id" *ngFor="let date of period">{{date.periods}}</option>
                    </select>
                  </div>
                  <div class="col-sm-3">
                    <label for="date_range">
                      {{searchNavForm.value.date_periods == 'Y' ? 'Year(From - To)' : (searchNavForm.value.date_periods == 'M' ? 'Month (From - To)'  : 'Date Range (From - To)')}}
                    </label>
                    <p-calendar
                    #dateRng
                    [view]="searchNavForm.value.date_periods == 'Y'  ? 'year' : (searchNavForm.value.date_periods == 'M' ? 'month' : 'date')"
                    [dateFormat]="searchNavForm.value.date_periods == 'Y'  ? 'yy' : (searchNavForm.value.date_periods == 'M' ? 'mm/yy' : 'dd/mm/yy')"
                    [appendTo]="'body'"
                    [placeholder]="searchNavForm.value.date_periods == 'Y' ? 'YYYY - YYYY' : (searchNavForm.value.date_periods == 'M' ? 'MM/YYYY - MM/YYYY' : 'DD/MM/YYYY - DD/MM/YYYY')"
                    formControlName="date_range"
                    selectionMode="range"
                    [readonlyInput]="true"
                    [maxDate]="maxDt"
                    inputId="'date_range'"
                    [showIcon]="true"
                    (onSelect)="setEndDate()"
                    [hideOnDateTimeSelect]="true"
                    [showButtonBar]="true">
                    </p-calendar>
                  </div>
                  <div class="col-sm-6 d-flex justify-content-end align-items-end">
                    <p-button label="Search" icon="pi pi-search" iconPos="left" type="submit"></p-button>
                  </div>
              </div>
              <!-- <div class="row mt-1">

              </div> -->
            </form>
       </div>
    </div>
  </div>
  <div class="col-sm-12 my-3">
     <div class="card">
      <!-- <div class="card-header">
        There are in total {{navDt.length}} nav
      </div> -->

      <div class="card-header sticky-header py-1 px-3 d-flex justify-content-between">
        <b class="m-0 d-flex align-items-center"><i class="pi pi-database mr-1" style="font-size:2rem"></i>NAV Reports</b>

        <div class="flex w-25">
          <span class="ml-auto">
              <input id="search" class="form-control rounded" type="text"
              (input)="filterGlobal($event)"
              placeholder="search"
               />
          </span>
      </div>

      </div>
      <div class="card-body">
        <!-- [autoLayout]="true" -->

        <p-table
        #primeTbl
        id="navDt"
        [value]="navDt"
        [responsive]="true"
        [rowHover]="true"
        styleClass="p-datatable-striped p-datatable-lg"
        responsiveLayout="scroll"
        [scrollable]="true"
        [columns]="navClmns"
        [autoLayout]="true"
        [paginator]="true"
        [totalRecords]="navDt.length"
        [pageLinks]="3"
        [rowsPerPageOptions]="[10,50,100,{ showAll: 'All' }]"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        [rows]="10"
        [showCurrentPageReport]="true"
        [globalFilterFields]="getColumnsForFilter()"
        [tableStyle]="{ 'min-width': '120rem' }"
        >
        <ng-template pTemplate="header">
          <tr >
              <th  *ngFor="let col of navClmns"
              [pSortableColumn]="col.field"
              [style.max-width]="col.width"
              [style.min-width]="col.field"
              >
                {{ col.header }}
                <p-sortIcon [field]="col.field">
                </p-sortIcon>
              </th>
          </tr>
      </ng-template>

      <ng-template pTemplate="body" let-nav  let-i="rowIndex">
        <tr tabindex="999">
          <td *ngFor="let col of navClmns"
          [style.max-width]="col.width"
          [style.min-width]="col.field">
            <ng-container [ngSwitch]="true">
              <ng-container *ngSwitchCase="col.field == 'sl_no'">
                <b>
                  {{i + 1}}
                </b>
             </ng-container>
             <ng-container *ngSwitchCase="col.field == 'nav_date'">
              <b [matTooltip]="nav[col.field] ? (nav[col.field] | date:'dd-MM-YYYY') : ''">
                 {{nav[col.field] ? (nav[col.field] | date:'dd-MM-YYYY') : 'N/A' }}
              </b>
           </ng-container>

             <ng-container *ngSwitchCase="col.field == 'amc_short_name'">
              <b [matTooltip]="nav['amc_name'] ? nav['amc_name'] : (nav['amc_short_name'] ? nav['amc_short_name'] : '') ">
                 {{nav['amc_name'] ? nav['amc_name'] : (nav['amc_short_name'] ? nav['amc_short_name'] : 'N/A') }}
              </b>
           </ng-container>
              <ng-container *ngSwitchDefault>
                <b [matTooltip]="nav[col.field]">{{ nav[col.field] ? nav[col.field] : 'N/A' }}</b>
              </ng-container>
            </ng-container>
          </td>
          </tr>
        </ng-template>

      <ng-template pTemplate="emptymessage" let-columns>
        <tr>
          <td [attr.colSpan]="columns.length" class="noHistoryAvailable">
             <h5>No Records Found</h5>
          </td>
        </tr>
      </ng-template>
        </p-table>
      </div>
     </div>
  </div>
</div>
